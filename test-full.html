<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ü–æ–ª–Ω—ã–π —Ç–µ—Å—Ç ParkEasyKG</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#2196F3">
    <style>
        .test-container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .test-section {
            background: white;
            margin: 20px 0;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .test-result {
            margin: 10px 0;
            padding: 10px;
            border-radius: 4px;
        }
        .success { background: #e8f5e9; color: #2e7d32; }
        .error { background: #ffebee; color: #c62828; }
        .warning { background: #fff3e0; color: #ef6c00; }
        .info { background: #e3f2fd; color: #1565c0; }
        button {
            background: #2196F3;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover { background: #1976D2; }
        .iframe-container {
            border: 1px solid #ddd;
            border-radius: 4px;
            overflow: hidden;
            margin: 10px 0;
        }
        iframe {
            width: 100%;
            height: 300px;
            border: none;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>üß™ –ü–æ–ª–Ω—ã–π —Ç–µ—Å—Ç ParkEasyKG</h1>
        
        <div class="test-section">
            <h2>üìã –°—Ç–∞—Ç—É—Å —Å–∏—Å—Ç–µ–º—ã</h2>
            <div id="system-status"></div>
            <button onclick="checkSystemStatus()">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–∏—Å—Ç–µ–º—É</button>
        </div>
        
        <div class="test-section">
            <h2>üìÑ –¢–µ—Å—Ç —Å—Ç—Ä–∞–Ω–∏—Ü</h2>
            <div id="pages-status"></div>
            <button onclick="testPages()">–¢–µ—Å—Ç —Å—Ç—Ä–∞–Ω–∏—Ü</button>
            
            <h3>–ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä:</h3>
            <div class="iframe-container">
                <iframe src="index.html" title="–ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞"></iframe>
            </div>
            
            <button onclick="openPage('index.html')">–û—Ç–∫—Ä—ã—Ç—å –≥–ª–∞–≤–Ω—É—é</button>
            <button onclick="openPage('map.html')">–û—Ç–∫—Ä—ã—Ç—å –∫–∞—Ä—Ç—É</button>
            <button onclick="openPage('fines.html')">–û—Ç–∫—Ä—ã—Ç—å —à—Ç—Ä–∞—Ñ—ã</button>
        </div>
        
        <div class="test-section">
            <h2>üîß –¢–µ—Å—Ç JavaScript</h2>
            <div id="js-status"></div>
            <button onclick="testJavaScript()">–¢–µ—Å—Ç JS –º–æ–¥—É–ª–µ–π</button>
        </div>
        
        <div class="test-section">
            <h2>üåê –¢–µ—Å—Ç —è–∑—ã–∫–æ–≤</h2>
            <div id="lang-status"></div>
            <button onclick="testLanguages()">–¢–µ—Å—Ç –ø–µ—Ä–µ–≤–æ–¥–æ–≤</button>
        </div>
        
        <div class="test-section">
            <h2>‚è±Ô∏è –¢–µ—Å—Ç —Ç–∞–π–º–µ—Ä–∞</h2>
            <div id="timer-status"></div>
            <div id="timer-display" style="font-size: 2rem; font-weight: bold; color: #2196F3; text-align: center; margin: 20px 0;">00:00:00</div>
            <button onclick="testTimer()">–¢–µ—Å—Ç —Ñ—É–Ω–∫—Ü–∏–π</button>
            <button onclick="startTimer()">–ó–∞–ø—É—Å—Ç–∏—Ç—å</button>
            <button onclick="stopTimer()">–û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å</button>
        </div>
        
        <div class="test-section">
            <h2>üì± –¢–µ—Å—Ç PWA</h2>
            <div id="pwa-status"></div>
            <button onclick="testPWA()">–¢–µ—Å—Ç PWA —Ñ—É–Ω–∫—Ü–∏–π</button>
            <button onclick="testServiceWorker()">–¢–µ—Å—Ç Service Worker</button>
        </div>
        
        <div class="test-section">
            <h2>üó∫Ô∏è –¢–µ—Å—Ç –∫–∞—Ä—Ç—ã</h2>
            <div id="map-status"></div>
            <button onclick="testMapData()">–¢–µ—Å—Ç –¥–∞–Ω–Ω—ã—Ö</button>
            <button onclick="testLeaflet()">–¢–µ—Å—Ç Leaflet</button>
        </div>
        
        <div class="test-section">
            <h2>üíæ –¢–µ—Å—Ç —Ö—Ä–∞–Ω–∏–ª–∏—â–∞</h2>
            <div id="storage-status"></div>
            <button onclick="testStorage()">–¢–µ—Å—Ç localStorage</button>
            <button onclick="clearAllData()">–û—á–∏—Å—Ç–∏—Ç—å –¥–∞–Ω–Ω—ã–µ</button>
        </div>
        
        <div class="test-section">
            <h2>üîî –¢–µ—Å—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π</h2>
            <div id="notifications-status"></div>
            <button onclick="testNotifications()">–¢–µ—Å—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π</button>
            <button onclick="requestNotificationPermission()">–ó–∞–ø—Ä–æ—Å–∏—Ç—å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ</button>
        </div>
        
        <div class="test-section">
            <h2>üìä –û–±—â–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç</h2>
            <div id="overall-status"></div>
            <button onclick="runAllTests()">–ó–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ —Ç–µ—Å—Ç—ã</button>
        </div>
    </div>

    <script>
        let testResults = {};
        let timerInterval = null;
        let timerStartTime = null;
        
        function showResult(sectionId, message, type = 'info') {
            const section = document.getElementById(sectionId);
            const div = document.createElement('div');
            div.className = `test-result ${type}`;
            div.innerHTML = message;
            section.appendChild(div);
        }
        
        function clearResults(sectionId) {
            document.getElementById(sectionId).innerHTML = '';
        }
        
        function checkSystemStatus() {
            clearResults('system-status');
            
            // –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –±—Ä–∞—É–∑–µ—Ä
            showResult('system-status', `–ë—Ä–∞—É–∑–µ—Ä: ${navigator.userAgent}`, 'info');
            showResult('system-status', `–†–∞–∑–º–µ—Ä —ç–∫—Ä–∞–Ω–∞: ${window.innerWidth}x${window.innerHeight}`, 'info');
            showResult('system-status', `–Ø–∑—ã–∫: ${navigator.language}`, 'info');
            showResult('system-status', `–û–Ω–ª–∞–π–Ω: ${navigator.onLine ? '–î–∞' : '–ù–µ—Ç'}`, navigator.onLine ? 'success' : 'warning');
            
            // –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∫—É —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π
            const features = [
                { name: 'localStorage', supported: 'localStorage' in window },
                { name: 'Service Worker', supported: 'serviceWorker' in navigator },
                { name: 'Notifications', supported: 'Notification' in window },
                { name: 'Geolocation', supported: 'geolocation' in navigator },
                { name: 'Fetch API', supported: 'fetch' in window },
                { name: 'Cache API', supported: 'caches' in window }
            ];
            
            features.forEach(feature => {
                showResult('system-status', 
                    `${feature.name}: ${feature.supported ? '‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è' : '‚ùå –ù–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è'}`,
                    feature.supported ? 'success' : 'error'
                );
            });
            
            testResults.system = features.every(f => f.supported);
        }
        
        function testPages() {
            clearResults('pages-status');
            
            const pages = ['index.html', 'map.html', 'fines.html', 'manifest.json', 'service-worker.js'];
            
            pages.forEach(page => {
                fetch(page)
                    .then(response => {
                        if (response.ok) {
                            showResult('pages-status', `‚úÖ ${page} - –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è (${response.status})`, 'success');
                        } else {
                            showResult('pages-status', `‚ùå ${page} - –æ—à–∏–±–∫–∞ ${response.status}`, 'error');
                        }
                    })
                    .catch(error => {
                        showResult('pages-status', `‚ùå ${page} - –Ω–µ –Ω–∞–π–¥–µ–Ω: ${error.message}`, 'error');
                    });
            });
            
            // –ü—Ä–æ–≤–µ—Ä–∏—Ç—å CSS –∏ JS —Ñ–∞–π–ª—ã
            const assets = ['css/style.css', 'js/app.js', 'js/language.js', 'js/timer.js', 'js/map.js', 'js/fines.js'];
            
            assets.forEach(asset => {
                fetch(asset)
                    .then(response => {
                        if (response.ok) {
                            showResult('pages-status', `‚úÖ ${asset} - –Ω–∞–π–¥–µ–Ω`, 'success');
                        } else {
                            showResult('pages-status', `‚ùå ${asset} - –æ—à–∏–±–∫–∞ ${response.status}`, 'error');
                        }
                    })
                    .catch(error => {
                        showResult('pages-status', `‚ùå ${asset} - –Ω–µ –Ω–∞–π–¥–µ–Ω`, 'error');
                    });
            });
        }
        
        function testJavaScript() {
            clearResults('js-status');
            
            try {
                // –¢–µ—Å—Ç –±–∞–∑–æ–≤–æ–≥–æ JS
                const obj = { test: 'value', number: 123, array: [1, 2, 3] };
                const json = JSON.stringify(obj);
                const parsed = JSON.parse(json);
                
                if (JSON.stringify(obj) === JSON.stringify(parsed)) {
                    showResult('js-status', '‚úÖ JSON —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç', 'success');
                } else {
                    showResult('js-status', '‚ùå –ü—Ä–æ–±–ª–µ–º–∞ —Å JSON', 'error');
                }
                
                // –¢–µ—Å—Ç Date
                const now = new Date();
                const timestamp = now.getTime();
                const formatted = formatTime(5000);
                
                if (timestamp > 0 && formatted === '00:00:05') {
                    showResult('js-status', '‚úÖ Date API –∏ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞–±–æ—Ç–∞—é—Ç', 'success');
                } else {
                    showResult('js-status', '‚ùå –ü—Ä–æ–±–ª–µ–º–∞ —Å Date API', 'error');
                }
                
                // –¢–µ—Å—Ç –∫–ª–∞—Å—Å–æ–≤
                class TestClass {
                    constructor() {
                        this.value = 'test';
                    }
                    getValue() {
                        return this.value;
                    }
                }
                
                const testInstance = new TestClass();
                if (testInstance.getValue() === 'test') {
                    showResult('js-status', '‚úÖ ES6 –∫–ª–∞—Å—Å—ã —Ä–∞–±–æ—Ç–∞—é—Ç', 'success');
                } else {
                    showResult('js-status', '‚ùå –ü—Ä–æ–±–ª–µ–º–∞ —Å ES6 –∫–ª–∞—Å—Å–∞–º–∏', 'error');
                }
                
                testResults.javascript = true;
                
            } catch (error) {
                showResult('js-status', `‚ùå JavaScript –æ—à–∏–±–∫–∞: ${error.message}`, 'error');
                testResults.javascript = false;
            }
        }
        
        function testLanguages() {
            clearResults('lang-status');
            
            try {
                // –°–∏–º—É–ª—è—Ü–∏—è –ø–µ—Ä–µ–≤–æ–¥–æ–≤
                const translations = {
                    ru: {
                        'welcome-title': '–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ ParkEasyKG',
                        'menu-map': '–ö–∞—Ä—Ç–∞ –ø–∞—Ä–∫–æ–≤–æ–∫',
                        'start-parking': '–ù–∞—á–∞—Ç—å –ø–∞—Ä–∫–æ–≤–∫—É'
                    },
                    ky: {
                        'welcome-title': 'ParkEasyKG\'–≥–∞ –∫–æ—à –∫–µ–ª–∏“£–∏–∑',
                        'menu-map': '–¢–æ–∫—Ç–æ—Ç—É—É –∂–∞–π–ª–∞—Ä—ã–Ω—ã–Ω –∫–∞—Ä—Ç–∞—Å—ã',
                        'start-parking': '–¢–æ–∫—Ç–æ—Ç—É—É–Ω—É –±–∞—à—Ç–æ–æ'
                    }
                };
                
                const ruKeys = Object.keys(translations.ru);
                const kyKeys = Object.keys(translations.ky);
                
                if (ruKeys.length === kyKeys.length) {
                    showResult('lang-status', `‚úÖ –ü–µ—Ä–µ–≤–æ–¥—ã —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω—ã (${ruKeys.length} –∫–ª—é—á–µ–π)`, 'success');
                } else {
                    showResult('lang-status', `‚ö†Ô∏è –ù–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –ø–µ—Ä–µ–≤–æ–¥–æ–≤: RU=${ruKeys.length}, KY=${kyKeys.length}`, 'warning');
                }
                
                // –¢–µ—Å—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —è–∑—ã–∫–∞
                localStorage.setItem('parkeasylang', 'ru');
                const saved = localStorage.getItem('parkeasylang');
                
                if (saved === 'ru') {
                    showResult('lang-status', '‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —è–∑—ã–∫–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç', 'success');
                } else {
                    showResult('lang-status', '‚ùå –ü—Ä–æ–±–ª–µ–º–∞ —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º —è–∑—ã–∫–∞', 'error');
                }
                
                testResults.languages = true;
                
            } catch (error) {
                showResult('lang-status', `‚ùå –û—à–∏–±–∫–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —è–∑—ã–∫–æ–≤: ${error.message}`, 'error');
                testResults.languages = false;
            }
        }
        
        function testTimer() {
            clearResults('timer-status');
            
            try {
                // –¢–µ—Å—Ç —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –≤—Ä–µ–º–µ–Ω–∏
                const tests = [
                    { input: 0, expected: '00:00:00' },
                    { input: 5000, expected: '00:00:05' },
                    { input: 65000, expected: '00:01:05' },
                    { input: 3665000, expected: '01:01:05' }
                ];
                
                let allPassed = true;
                tests.forEach(test => {
                    const result = formatTime(test.input);
                    if (result === test.expected) {
                        showResult('timer-status', `‚úÖ ${test.input}ms ‚Üí ${result}`, 'success');
                    } else {
                        showResult('timer-status', `‚ùå ${test.input}ms ‚Üí ${result} (–æ–∂–∏–¥–∞–ª–æ—Å—å ${test.expected})`, 'error');
                        allPassed = false;
                    }
                });
                
                if (allPassed) {
                    showResult('timer-status', '‚úÖ –í—Å–µ —Ç–µ—Å—Ç—ã —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–æ—à–ª–∏', 'success');
                }
                
                testResults.timer = allPassed;
                
            } catch (error) {
                showResult('timer-status', `‚ùå –û—à–∏–±–∫–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Ç–∞–π–º–µ—Ä–∞: ${error.message}`, 'error');
                testResults.timer = false;
            }
        }
        
        function startTimer() {
            if (timerInterval) {
                clearInterval(timerInterval);
            }
            
            timerStartTime = Date.now();
            timerInterval = setInterval(() => {
                const elapsed = Date.now() - timerStartTime;
                document.getElementById('timer-display').textContent = formatTime(elapsed);
            }, 1000);
            
            showResult('timer-status', '‚úÖ –¢–∞–π–º–µ—Ä –∑–∞–ø—É—â–µ–Ω', 'success');
        }
        
        function stopTimer() {
            if (timerInterval) {
                clearInterval(timerInterval);
                timerInterval = null;
                document.getElementById('timer-display').textContent = '00:00:00';
                showResult('timer-status', '‚úÖ –¢–∞–π–º–µ—Ä –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω', 'success');
            }
        }
        
        function testPWA() {
            clearResults('pwa-status');
            
            const checks = [
                { name: 'Service Worker', check: 'serviceWorker' in navigator },
                { name: 'Cache API', check: 'caches' in window },
                { name: 'Fetch API', check: 'fetch' in window },
                { name: 'Notifications', check: 'Notification' in window },
                { name: 'HTTPS/localhost', check: location.protocol === 'https:' || location.hostname === 'localhost' || location.hostname === '127.0.0.1' }
            ];
            
            let allSupported = true;
            checks.forEach(check => {
                if (check.check) {
                    showResult('pwa-status', `‚úÖ ${check.name} –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è`, 'success');
                } else {
                    showResult('pwa-status', `‚ùå ${check.name} –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è`, 'error');
                    allSupported = false;
                }
            });
            
            testResults.pwa = allSupported;
        }
        
        function testServiceWorker() {
            if ('serviceWorker' in navigator) {
                navigator.serviceWorker.register('service-worker.js')
                    .then(registration => {
                        showResult('pwa-status', '‚úÖ Service Worker –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω', 'success');
                        showResult('pwa-status', `Scope: ${registration.scope}`, 'info');
                    })
                    .catch(error => {
                        showResult('pwa-status', `‚ùå –û—à–∏–±–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ SW: ${error.message}`, 'error');
                    });
            } else {
                showResult('pwa-status', '‚ùå Service Worker –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è', 'error');
            }
        }
        
        function testMapData() {
            clearResults('map-status');
            
            try {
                // –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –ø–∞—Ä–∫–æ–≤–æ–∫
                const parkingData = [
                    { id: 1, name: '–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–∞—è –ø–ª–æ—â–∞–¥—å', coords: [42.8746, 74.5698], city: '–ë–∏—à–∫–µ–∫' },
                    { id: 2, name: '–¶–µ–Ω—Ç—Ä –û—à–∞', coords: [40.5283, 72.7985], city: '–û—à' }
                ];
                
                showResult('map-status', `‚úÖ –î–∞–Ω–Ω—ã–µ –ø–∞—Ä–∫–æ–≤–æ–∫ –∑–∞–≥—Ä—É–∂–µ–Ω—ã (${parkingData.length} –∑–∞–ø–∏—Å–µ–π)`, 'success');
                
                // –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã
                parkingData.forEach(parking => {
                    const [lat, lng] = parking.coords;
                    if (lat >= 39 && lat <= 44 && lng >= 69 && lng <= 81) {
                        showResult('map-status', `‚úÖ ${parking.name} - –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã`, 'success');
                    } else {
                        showResult('map-status', `‚ö†Ô∏è ${parking.name} - –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –≤–Ω–µ –ö—ã—Ä–≥—ã–∑—Å—Ç–∞–Ω–∞`, 'warning');
                    }
                });
                
                testResults.mapData = true;
                
            } catch (error) {
                showResult('map-status', `‚ùå –û—à–∏–±–∫–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –∫–∞—Ä—Ç—ã: ${error.message}`, 'error');
                testResults.mapData = false;
            }
        }
        
        function testLeaflet() {
            // –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∑–∞–≥—Ä—É–∑–∫—É Leaflet
            const script = document.createElement('script');
            script.src = 'https://unpkg.com/leaflet@1.9.4/dist/leaflet.js';
            script.onload = () => {
                if (typeof L !== 'undefined') {
                    showResult('map-status', '‚úÖ Leaflet –∑–∞–≥—Ä—É–∂–µ–Ω —É—Å–ø–µ—à–Ω–æ', 'success');
                } else {
                    showResult('map-status', '‚ùå Leaflet –Ω–µ –∑–∞–≥—Ä—É–∑–∏–ª—Å—è', 'error');
                }
            };
            script.onerror = () => {
                showResult('map-status', '‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ Leaflet', 'error');
            };
            document.head.appendChild(script);
        }
        
        function testStorage() {
            clearResults('storage-status');
            
            try {
                // –¢–µ—Å—Ç —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ç–∏–ø–æ–≤ –¥–∞–Ω–Ω—ã—Ö
                const testData = {
                    string: 'test',
                    number: 123,
                    boolean: true,
                    array: [1, 2, 3],
                    object: { nested: 'value' }
                };
                
                localStorage.setItem('test-complex', JSON.stringify(testData));
                const retrieved = JSON.parse(localStorage.getItem('test-complex'));
                
                if (JSON.stringify(testData) === JSON.stringify(retrieved)) {
                    showResult('storage-status', '‚úÖ –°–ª–æ–∂–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ', 'success');
                } else {
                    showResult('storage-status', '‚ùå –ü—Ä–æ–±–ª–µ–º–∞ —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º —Å–ª–æ–∂–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö', 'error');
                }
                
                // –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–∑–º–µ—Ä —Ö—Ä–∞–Ω–∏–ª–∏—â–∞
                let totalSize = 0;
                for (let key in localStorage) {
                    if (localStorage.hasOwnProperty(key)) {
                        totalSize += localStorage[key].length;
                    }
                }
                
                showResult('storage-status', `–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ localStorage: ${totalSize} —Å–∏–º–≤–æ–ª–æ–≤`, 'info');
                
                localStorage.removeItem('test-complex');
                testResults.storage = true;
                
            } catch (error) {
                showResult('storage-status', `‚ùå –û—à–∏–±–∫–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Ö—Ä–∞–Ω–∏–ª–∏—â–∞: ${error.message}`, 'error');
                testResults.storage = false;
            }
        }
        
        function testNotifications() {
            clearResults('notifications-status');
            
            if ('Notification' in window) {
                showResult('notifications-status', '‚úÖ API —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è', 'success');
                showResult('notifications-status', `–°—Ç–∞—Ç—É—Å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π: ${Notification.permission}`, 'info');
                
                if (Notification.permission === 'granted') {
                    showResult('notifications-status', '‚úÖ –†–∞–∑—Ä–µ—à–µ–Ω–∏–µ –ø–æ–ª—É—á–µ–Ω–æ', 'success');
                    
                    // –ü–æ–∫–∞–∑–∞—Ç—å —Ç–µ—Å—Ç–æ–≤–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
                    new Notification('–¢–µ—Å—Ç ParkEasyKG', {
                        body: '–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ!',
                        icon: 'icons/icon-192x192.svg'
                    });
                } else if (Notification.permission === 'denied') {
                    showResult('notifications-status', '‚ùå –†–∞–∑—Ä–µ—à–µ–Ω–∏–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–æ', 'error');
                } else {
                    showResult('notifications-status', '‚ö†Ô∏è –†–∞–∑—Ä–µ—à–µ–Ω–∏–µ –Ω–µ –∑–∞–ø—Ä–æ—à–µ–Ω–æ', 'warning');
                }
                
                testResults.notifications = Notification.permission === 'granted';
            } else {
                showResult('notifications-status', '‚ùå –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è', 'error');
                testResults.notifications = false;
            }
        }
        
        function requestNotificationPermission() {
            if ('Notification' in window) {
                Notification.requestPermission().then(permission => {
                    showResult('notifications-status', `–†–∞–∑—Ä–µ—à–µ–Ω–∏–µ: ${permission}`, 
                        permission === 'granted' ? 'success' : 'warning');
                });
            }
        }
        
        function clearAllData() {
            localStorage.clear();
            showResult('storage-status', '‚úÖ –í—Å–µ –¥–∞–Ω–Ω—ã–µ localStorage –æ—á–∏—â–µ–Ω—ã', 'success');
        }
        
        function openPage(page) {
            window.open(page, '_blank');
        }
        
        function runAllTests() {
            clearResults('overall-status');
            testResults = {};
            
            showResult('overall-status', 'üöÄ –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤...', 'info');
            
            setTimeout(() => {
                checkSystemStatus();
                testJavaScript();
                testLanguages();
                testTimer();
                testPWA();
                testMapData();
                testStorage();
                testNotifications();
                
                setTimeout(() => {
                    const passed = Object.values(testResults).filter(Boolean).length;
                    const total = Object.keys(testResults).length;
                    
                    if (passed === total) {
                        showResult('overall-status', `üéâ –í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ–π–¥–µ–Ω—ã! (${passed}/${total})`, 'success');
                    } else {
                        showResult('overall-status', `‚ö†Ô∏è –ü—Ä–æ–π–¥–µ–Ω–æ —Ç–µ—Å—Ç–æ–≤: ${passed}/${total}`, 'warning');
                    }
                    
                    showResult('overall-status', '–î–µ—Ç–∞–ª–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤:', 'info');
                    Object.entries(testResults).forEach(([test, result]) => {
                        showResult('overall-status', 
                            `${result ? '‚úÖ' : '‚ùå'} ${test}`, 
                            result ? 'success' : 'error'
                        );
                    });
                }, 2000);
            }, 500);
        }
        
        function formatTime(milliseconds) {
            const totalSeconds = Math.floor(milliseconds / 1000);
            const hours = Math.floor(totalSeconds / 3600);
            const minutes = Math.floor((totalSeconds % 3600) / 60);
            const seconds = totalSeconds % 60;
            
            return `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
        }
        
        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∑–∞–ø—É—Å–∫ –±–∞–∑–æ–≤—ã—Ö —Ç–µ—Å—Ç–æ–≤
        window.onload = function() {
            console.log('üß™ –ü–æ–ª–Ω—ã–π —Ç–µ—Å—Ç ParkEasyKG –∑–∞–≥—Ä—É–∂–µ–Ω');
            
            // –ó–∞–ø—É—Å—Ç–∏—Ç—å –±–∞–∑–æ–≤—ã–µ —Ç–µ—Å—Ç—ã —á–µ—Ä–µ–∑ 1 —Å–µ–∫—É–Ω–¥—É
            setTimeout(() => {
                checkSystemStatus();
                testJavaScript();
            }, 1000);
        };
    </script>
</body>
</html>